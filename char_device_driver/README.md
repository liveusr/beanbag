# simple character device driver

- **Create a simple module**
  - Write init() and exit() functions
  - Create *Kbuild* and *Makefile*
  - Build program by running `make`
  - Insert module using `insmod`
  - Check output of `dmesg` and `lsmod`
  - Remove module using `rmmod` and check `dmesg`/`lsmod` output
  - Reference code: [click here](https://github.com/liveusr/beanbag/tree/d28fd3e51874b24c67269699cd0868e6dbd25b32/char_device_driver)
- **Create a device file**
  - What is device major and minor number?
  - Create a character device file using `mknod`
  - Read device file using `cat`
  - Write to device file using `echo`
  - Notice the error/message and `dmesg` output for both read/write
- **Convert module to character device driver**
  - Call `register_chardev()` from init() function
  - `register_chardev()` arguments? - research! (Hint: check *linux/fs.h*)
  - Call `unregister_chardev()` from exit() function
  - Build and `insmod`
  - Check `dmesg` output
  - Read/write to device file and check `dmesg` output
  - `rmmod` and check `dmesg` output
  - Reference code: [click here](https://github.com/liveusr/beanbag/tree/bbda2c44fd9c36920d66d0ecbcdb4f595671ef78/char_device_driver)
- **Add open() and release() functions**
  - Write empty open() and release() functions (function signatures? Hint: *linux/fs.h*)
  - Initialize `file_operations` object with both functionâ€™s pointer
  - Build, `insmod` and check `dmesg` output
  - Read/write to device file and check `dmesg` output
  - `rmmod` and check `dmesg` output
  - Reference code: [click here](https://github.com/liveusr/beanbag/tree/747e9751642f5859abc2eea7f094658e63103b04/char_device_driver)
- **Print device major and minor number in open()/release() functions**
  - Find how to get the device number from `inode` object
  - Reference code: [click here](https://github.com/liveusr/beanbag/tree/a76a7bfb42081564fe8587a0e655f895163d09c0/char_device_driver)
- **Add read() and write() functions**
  - Write empty read() and write() functions and update `file_operations` object
  - Build, `insmod` and check `dmesg` output
  - Read/write to device file and check `dmesg` output
  - Reference code: [click here](https://github.com/liveusr/beanbag/tree/e1ebf89ec3b8d7ec4796ae6cc56069506f32fe9e/char_device_driver)
- **Any issue?**
  - Why does `echo` never return?
  - Fix it (Hint: return `count` from write())
  - Reference code: [click here](https://github.com/liveusr/beanbag/tree/e8e599ece9e024a15639559bc1843ac8ef681dfa/char_device_driver)
- **Print device major and minor in read()/write functions**
  - Find how to get the device number from `file` object
